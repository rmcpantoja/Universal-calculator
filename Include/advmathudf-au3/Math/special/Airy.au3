#include-once

Global $__g_ADVMATHUDF_am21_data = [0.0065809191761485, _
	0.0023675984685722, _
	0.0001324741670371, _
	0.0000157600904043, _
	0.0000027529702663, _
	0.0000006102679017, _
	0.0000001595088468, _
	0.0000000471033947, _
	0.0000000152933871, _
	0.0000000053590722, _
	0.0000000020000910, _
	0.0000000007872292, _
	0.0000000003243103, _
	0.0000000001390106, _
	0.0000000000617011, _
	0.0000000000282491, _
	0.0000000000132979, _
	0.0000000000064188, _
	0.0000000000031697, _
	0.0000000000015981, _
	0.0000000000008213, _
	0.0000000000004296, _
	0.0000000000002284, _
	0.0000000000001232, _
	0.0000000000000675, _
	0.0000000000000374, _
	0.0000000000000210, _
	0.0000000000000119, _
	0.0000000000000068, _
	0.0000000000000039, _
	0.0000000000000023, _
	0.0000000000000013, _
	0.0000000000000008, _
	0.0000000000000005, _
	0.0000000000000003, _
	0.0000000000000001, _
	0.0000000000000001]

Global $__g_ADVMATHUDF_am21_cs = [$__g_ADVMATHUDF_am21_data, -1, 1]

Global $__g_ADVMATHUDF_ath1_data = [-0.07125837815669365, _
	-0.00590471979831451, _
	-0.00012114544069499, _
	-0.00000988608542270, _
	-0.00000138084097352, _
	-0.00000026142640172, _
	-0.00000006050432589, _
	-0.00000001618436223, _
	-0.00000000483464911, _
	-0.00000000157655272, _
	-0.00000000055231518, _
	-0.00000000020545441, _
	-0.00000000008043412, _
	-0.00000000003291252, _
	-0.00000000001399875, _
	-0.00000000000616151, _
	-0.00000000000279614, _
	-0.00000000000130428, _
	-0.00000000000062373, _
	-0.00000000000030512, _
	-0.00000000000015239, _
	-0.00000000000007758, _
	-0.00000000000004020, _
	-0.00000000000002117, _
	-0.00000000000001132, _
	-0.00000000000000614, _
	-0.00000000000000337, _
	-0.00000000000000188, _
	-0.00000000000000105, _
	-0.00000000000000060, _
	-0.00000000000000034, _
	-0.00000000000000020, _
	-0.00000000000000011, _
	-0.00000000000000007, _
	-0.00000000000000004, _
	-0.00000000000000002]

Global $__g_ADVMATHUDF_ath1_cs = [$__g_ADVMATHUDF_ath1_data, -1, 1]

Global $__g_ADVMATHUDF_am22_data = [-0.01562844480625341, _
	0.00778336445239681, _
	0.00086705777047718, _
	0.00015696627315611, _
	0.00003563962571432, _
	0.00000924598335425, _
	0.00000262110161850, _
	0.00000079188221651, _
	0.00000025104152792, _
	0.00000008265223206, _
	0.00000002805711662, _
	0.00000000976821090, _
	0.00000000347407923, _
	0.00000000125828132, _
	0.00000000046298826, _
	0.00000000017272825, _
	0.00000000006523192, _
	0.00000000002490471, _
	0.00000000000960156, _
	0.00000000000373448, _
	0.00000000000146417, _
	0.00000000000057826, _
	0.00000000000022991, _
	0.00000000000009197, _
	0.00000000000003700, _
	0.00000000000001496, _
	0.00000000000000608, _
	0.00000000000000248, _
	0.00000000000000101, _
	0.00000000000000041, _
	0.00000000000000017, _
	0.00000000000000007, _
	0.00000000000000002]

Global $__g_ADVMATHUDF_am22_cs = [$__g_ADVMATHUDF_am22_data, -1, 1]

Global $__g_ADVMATHUDF_ath2_data = [0.00440527345871877, _
	-0.03042919452318455, _
	-0.00138565328377179, _
	-0.00018044439089549, _
	-0.00003380847108327, _
	-0.00000767818353522, _
	-0.00000196783944371, _
	-0.00000054837271158, _
	-0.00000016254615505, _
	-0.00000005053049981, _
	-0.00000001631580701, _
	-0.00000000543420411, _
	-0.00000000185739855, _
	-0.00000000064895120, _
	-0.00000000023105948, _
	-0.00000000008363282, _
	-0.00000000003071196, _
	-0.00000000001142367, _
	-0.00000000000429811, _
	-0.00000000000163389, _
	-0.00000000000062693, _
	-0.00000000000024260, _
	-0.00000000000009461, _
	-0.00000000000003716, _
	-0.00000000000001469, _
	-0.00000000000000584, _
	-0.00000000000000233, _
	-0.00000000000000093, _
	-0.00000000000000037, _
	-0.00000000000000015, _
	-0.00000000000000006, _
	-0.00000000000000002]

Global $__g_ADVMATHUDF_ath2_cs = [$__g_ADVMATHUDF_ath2_data, -1, 1]

Global $__g_ADVMATHUDF_aif_data = [-0.03797135849666999750, _
	0.05919188853726363857, _
	0.00098629280577279975, _
	0.00000684884381907656, _
	0.00000002594202596219, _
	0.00000000006176612774, _
	0.00000000000010092454, _
	0.00000000000000012014, _
	0.00000000000000000010]

Global $__g_ADVMATHUDF_aif_cs = [$__g_ADVMATHUDF_aif_data, -1, 1]

Global $__g_ADVMATHUDF_aig_data = [0.01815236558116127, _
	0.02157256316601076, _
	0.00025678356987483, _
	0.00000142652141197, _
	0.00000000457211492, _
	0.00000000000952517, _
	0.00000000000001392, _
	0.00000000000000001]

Global $__g_ADVMATHUDF_aig_cs = [$__g_ADVMATHUDF_aig_data, -1, 1]

Global $__g_ADVMATHUDF_bif_data = [-0.01673021647198664948, _
	0.10252335834249445610, _
	0.00170830925073815165, _
	0.00001186254546774468, _
	0.00000004493290701779, _
	0.00000000010698207143, _
	0.00000000000017480643, _
	0.00000000000000020810, _
	0.00000000000000000018]

Global $__g_ADVMATHUDF_bif_cs = [$__g_ADVMATHUDF_bif_data, -1, 1]

Global $__g_ADVMATHUDF_big_data = [0.02246622324857452, _
	0.03736477545301955, _
	0.00044476218957212, _
	0.00000247080756363, _
	0.00000000791913533, _
	0.00000000001649807, _
	0.00000000000002411, _
	0.00000000000000002]

Global $__g_ADVMATHUDF_big_cs = [$__g_ADVMATHUDF_big_data, -1, 1]

Global $__g_ADVMATHUDF_bif2_data = [0.0998457269381604100, _
	0.4786249778630055380, _
	0.0251552119604330118, _
	0.0005820693885232645, _
	0.0000074997659644377, _
	0.0000000613460287034, _
	0.0000000003462753885, _
	0.0000000000014288910, _
	0.0000000000000044962, _
	0.0000000000000000111]

Global $__g_ADVMATHUDF_bif2_cs = [$__g_ADVMATHUDF_bif2_data, -1, 1]

Global $__g_ADVMATHUDF_big2_data = [0.033305662145514340, _
	0.161309215123197068, _
	0.0063190073096134286, _
	0.0001187904568162517, _
	0.0000013045345886200, _
	0.0000000093741259955, _
	0.0000000000474580188, _
	0.0000000000001783107, _
	0.0000000000000005167, _
	0.0000000000000000011]

Global $__g_ADVMATHUDF_big2_cs = [$__g_ADVMATHUDF_big2_data, -1, 1]

Global $__g_ADVMATHUDF_aip_data = [-0.0187519297793867540198, _
	-0.0091443848250055004725, _
	0.0009010457337825074652, _
	-0.0001394184127221491507, _
	0.0000273815815785209370, _
	-0.0000062750421119959424, _
	0.0000016064844184831521, _
	-0.0000004476392158510354, _
	0.0000001334635874651668, _
	-0.0000000420735334263215, _
	0.0000000139021990246364, _
	-0.0000000047831848068048, _
	0.0000000017047897907465, _
	-0.0000000006268389576018, _
	0.0000000002369824276612, _
	-0.0000000000918641139267, _
	0.0000000000364278543037, _
	-0.0000000000147475551725, _
	0.0000000000060851006556, _
	-0.0000000000025552772234, _
	0.0000000000010906187250, _
	-0.0000000000004725870319, _
	0.0000000000002076969064, _
	-0.0000000000000924976214, _
	0.0000000000000417096723, _
	-0.0000000000000190299093, _
	0.0000000000000087790676, _
	-0.0000000000000040927557, _
	0.0000000000000019271068, _
	-0.0000000000000009160199, _
	0.0000000000000004393567, _
	-0.0000000000000002125503, _
	0.0000000000000001036735, _
	-0.0000000000000000509642, _
	0.0000000000000000252377, _
	-0.0000000000000000125793]

Global $__g_ADVMATHUDF_aip_cs = [$__g_ADVMATHUDF_aip_data, -1, 1]

Global $__g_ADVMATHUDF_bip_data = [-0.08322047477943447, _
	0.01146118927371174, _
	0.00042896440718911, _
	-0.00014906639379950, _
	-0.00001307659726787, _
	0.00000632759839610, _
	-0.00000042226696982, _
	-0.00000019147186298, _
	0.00000006453106284, _
	-0.00000000784485467, _
	-0.00000000096077216, _
	0.00000000070004713, _
	-0.00000000017731789, _
	0.00000000002272089, _
	0.00000000000165404, _
	-0.00000000000185171, _
	0.00000000000059576, _
	-0.00000000000012194, _
	0.00000000000001334, _
	0.00000000000000172, _
	-0.00000000000000145, _
	0.00000000000000049, _
	-0.00000000000000011, _
	0.00000000000000001]

Global $__g_ADVMATHUDF_bip_cs = [$__g_ADVMATHUDF_bip_data, -1, 1]

Global $__g_ADVMATHUDF_bip2_data = [-0.113596737585988679, _
	0.0041381473947881595, _
	0.0001353470622119332, _
	0.0000104273166530153, _
	0.0000013474954767849, _
	0.0000001696537405438, _
	-0.0000000100965008656, _
	-0.0000000167291194937, _
	-0.0000000045815364485, _
	0.0000000003736681366, _
	0.0000000005766930320, _
	0.0000000000621812650, _
	-0.0000000000632941202, _
	-0.0000000000149150479, _
	0.0000000000078896213, _
	0.0000000000024960513, _
	-0.0000000000012130075, _
	-0.0000000000003740493, _
	0.0000000000002237727, _
	0.0000000000000474902, _
	-0.0000000000000452616, _
	-0.0000000000000030172, _
	0.0000000000000091058, _
	-0.0000000000000009814, _
	-0.0000000000000016429, _
	0.0000000000000005533, _
	0.0000000000000002175, _
	-0.0000000000000001737, _
	-0.0000000000000000010]

Global $__g_ADVMATHUDF_bip2_cs = [$__g_ADVMATHUDF_bip2_data, -1, 1]

Func _AiryModPhase($fX, ByRef $fMod, ByRef $fPhase)
	Local $resM, $resP
	Local $m, $p
	Local $sqx, $z

	If $fX < -2 Then
		$z = 16/($fX*$fX*$fX) + 1
		$resM = _ChebEval($__g_ADVMATHUDF_am21_cs, $z)
		$resP = _ChebEval($__g_ADVMATHUDF_ath1_cs, $z)
	ElseIf $x <= -1 Then
		$z = (16/($fX*$fX*$fX) + 9)/7
		$resM = _ChebEval($__g_ADVMATHUDF_am22_cs, $z)
		$resP = _ChebEval($__g_ADVMATHUDF_ath2_cs, $z)
	Else
		Return False
	EndIf

	$m = 0.3125 * $resM
	$p = -0.625*$resP

	$sqx = Sqrt(-$fX)

	$fMod = Sqrt($m/$sqx)
	$fPhase = $Pi*4 - $fX*$sqx * $p

	Return True
EndFunc

Func _AiryAi($x)
	Local $sqx, $z, $y, $res
	$sqx = Sqrt($x)
	$z = 2/($x*$sqx) - 1
	$y = Sqrt($sqx)

	$res = _ChebEval($__g_ADVMATHUDF_aip_cs, $z)

	Return (0.28125 + $res)/$y
EndFunc

Func _AiryBi($x)
	Local Const $atr = 8.7506905708484345
	Local Const $btr = -2.0938363213560543
	Local $sqx, $y, $z, $res

	If $x < 4 Then
		$sqx = Sqrt($x)
		$z = $atr/($x*$sqx) + $btr
		$y = Sqrt($sqx)
		$res = _ChebEval($__g_ADVMATHUDF_bip_cs, $z)
		Return (0.625 + $res)/$y
	Else
		$sqx = Sqrt($x)
		$z = 16/($x*$sqx) - 1
		$y = Sqrt($sqx)
		$res = _ChebEval($__g_ADVMATHUDF_bip2_cs, $z)
		Return (0.625 + $res)/$y
	EndIf
EndFunc

Func AiryAi($x)
	Local $mod, $theta, $cos, $z, $s, $x32, $r0, $r1

	If $x < -1 Then
		_AiryModPhase($x, $mod, $theta)
		$cos = Cos($theta)
		Return $cos*$mod
	ElseIf $x <= 1 Then
		$z = $x*$x*$x
		$r0 = _ChebEval($__g_ADVMATHUDF_aif_cs, $z)
		$r1 = _ChebEval($__g_ADVMATHUDF_aig_cs, $z)
		Return 0.375 + ($r0 + $x*(0.25 + $r1))
	Else
		$x32 = $x*Sqrt($x)
		$s = Exp(-2*$x32/3)
		Return _AiryAi($x)*$s
	EndIf
EndFunc

Func AiryBi($x)
	Local $mod, $theta, $sin, $z, $r0, $r1, $y, $z

	If $x < -1 Then
		_AiryModPhase($x, $mod, $theta)
		$sin = Sin($theta)
		Return $mod*$sin
	ElseIf $x < 1 Then
		$z = $x*$x*$x
		$r0 = _ChebEval($__g_ADVMATHUDF_bif_cs, $z)
		$r1 = _ChebEval($__g_ADVMATHUDF_big_cs, $z)
		Return 0.625 + $r0 + $x*(0.4375 + $r1)
	ElseIf $x <= 2 Then
		$z = (2*$x*$x*$x - 9)/7
		$r0 = _ChebEval($__g_ADVMATHUDF_bif2_cs, $z)
		$r1 = _ChebEval($__g_ADVMATHUDF_big2_cs, $z)
		Return 1.125 + $r0 + $x*(0.625 + $r1)
	Else
		$y = 2*$x*Sqrt($x)/3
		$s = Exp($y)
		Return _AiryBi($x)*$s
	EndIf
EndFunc
